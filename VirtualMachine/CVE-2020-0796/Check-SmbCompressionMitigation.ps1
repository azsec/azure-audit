$releaseNumber =  (Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion").ReleaseId
$registry = Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters"
$result = $releaseNumber -in (1903, 1909) -and `
          $registry.DisableCompression -eq "1" 

if ($result -eq $true) {
    Write-Host -ForegroundColor Green "[-] SMBv3 Compression has been disabled"
}
elseif ($result -ne $true) {
    Write-Host -ForegroundColor Red "[-] SMBv3 Compression hasn't been disabled"
}

<#
$parameters = @{
    Path  = "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters"
    Name  = 'DisableCompression'
    Type  = 'DWORD'
    Value = 1
    Force = $true
}
Set-ItemProperty @parameters
#>